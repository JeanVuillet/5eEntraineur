<template id="template-starship-game">
  <style>
    /* ========================================================== */
    /* --- CORRECTION APPLIQUÉE ICI --- */
    /* On réduit la marge verticale pour rapprocher la question du jeu */
    /* ========================================================== */
    .question-zone { 
      margin: 8px 0; /* Était 16px 0 */
      font-size: 1.5em; 
      text-align: center; 
      min-height: 2.5em; 
    }
    
    #starship-game-area {
      position: relative;
      height: clamp(400px, 60vh, 700px); 
      background: #0c0a18;
      border-radius: 12px;
      overflow: hidden;
      cursor: crosshair;
      margin-top: 10px;
    }
    
    #ship { position: absolute; bottom: 10px; left: 50%; width: 60px; height: 60px; transform: translateX(-50%); background: url('/images/ship.png') center/contain no-repeat; transition: left 0.1s linear; }
    .falling-answer { position: absolute; top: -80px; padding: 10px 20px; background: #333; color: white; border: 2px solid #00f2ff; border-radius: 8px; font-weight: bold; animation: fall 30s linear forwards; }
    @keyframes fall { from { top: -80px; } to { top: 100%; } }
    .missile { position: absolute; width: 8px; height: 25px; background-color: #ffeb3b; border-radius: 4px; box-shadow: 0 0 10px #ffeb3b; }
  </style>
  
  <div id="question" class="question-zone"></div>
  <div id="starship-game-area">
    <div id="ship"></div>
  </div>
</template>

<script>
// Le script JavaScript reste exactement le même
class StarshipGame{constructor(t,e){this.container=t,this.controller=e,this.gameArea=t.querySelector("#starship-game-area"),this.ship=t.querySelector("#ship"),this.questionElement=t.querySelector("#question"),this.missiles=[],this.answers=[],this.currentQuestion=null,this.animationFrameId=null,this.timeoutId=null,this.bindControls()}loadQuestion(t){this.currentQuestion=t,this.questionElement.textContent=t.q,this.clearObjects(),this.spawnAnswers()}bindControls(){document.addEventListener("keydown",t=>{if(this.controller.getState().isLocked)return;"ArrowLeft"===t.key&&this.moveShip(-40),"ArrowRight"===t.key&&this.moveShip(40),"Space"===t.code&&(t.preventDefault(),this.shoot())})}moveShip(t){const e=this.ship.offsetLeft+t,o=this.gameArea.offsetWidth-this.ship.offsetWidth;this.ship.style.left=Math.max(0,Math.min(o,e))+"px"}shoot(){if(this.missiles.length>3)return;const t=document.createElement("div");t.className="missile",t.style.left=this.ship.offsetLeft+this.ship.offsetWidth/2-4+"px",t.style.bottom="70px",this.gameArea.appendChild(t),this.missiles.push(t)}spawnAnswers(){let t=[10,25,40,55,70,85].sort(()=>.5-Math.random());this.currentQuestion.options.forEach((e,o)=>{const i=document.createElement("div");i.className="falling-answer",i.style.left=`${t[o]}%`,i.style.animationDelay=`${2*Math.random()}s`,i.textContent=e,e===this.currentQuestion.a&&(i.dataset.isCorrect="true"),this.gameArea.appendChild(i),this.answers.push(i)}),this.timeoutId=setTimeout(()=>{this.answers.find(t=>"true"===t.dataset.isCorrect)&&(this.resetAnimation(),this.controller.notifyWrongAnswer(null))},30500)}gameLoop(){this.updateMissiles(),this.checkCollisions(),this.animationFrameId=requestAnimationFrame(()=>this.gameLoop())}updateMissiles(){for(let t=this.missiles.length-1;t>=0;t--){const e=this.missiles[t];let o=parseFloat(e.style.bottom);e.style.bottom=o+10+"px",o>this.gameArea.offsetHeight&&(e.remove(),this.missiles.splice(t,1))}}checkCollisions(){for(let t=this.missiles.length-1;t>=0;t--)for(let e=this.answers.length-1;e>=0;e--){const o=this.missiles[t],i=this.answers[e];if(this.isColliding(o,i)){this.resetAnimation();const t=i.textContent===this.currentQuestion.a;return t?this.controller.notifyCorrectAnswer():(localScores[currentIndex]=Math.max(0,localScores[currentIndex]-1),updateBars(),void this.controller.notifyWrongAnswer(this.currentQuestion))}}}isColliding(t,e){const o=t.getBoundingClientRect(),i=e.getBoundingClientRect();return!(o.right<i.left||o.left>i.right||o.bottom<i.top||o.top>i.bottom)}clearObjects(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.answers.forEach(t=>t.remove()),this.missiles.forEach(t=>t.remove()),this.answers=[],this.missiles=[]}startAnimation(){this.gameLoop()}resetAnimation(){cancelAnimationFrame(this.animationFrameId),this.clearObjects()}}
window.StarshipGame=StarshipGame;
</script>